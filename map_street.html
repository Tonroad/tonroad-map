<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>TonRoad</title>
  <style>
    html, body { margin:0; padding:0; height:100%; }
    #map { height:30%; width:100%; }
    #street-view { height:70%; width:100%; }
    #modeLabel {
      position: absolute; top: 10px; left: 10px;
      background: red; color: white; padding: 5px 10px;
      z-index: 1000; cursor: pointer;
    }
    #voteResults {
      position: absolute; top: 50px; left: 10px;
      background: rgba(0,0,0,0.7); color: white; padding: 5px 10px;
      z-index: 1000;
    }
    #citySelect {
      position: absolute; top: 10px; right: 10px;
      z-index: 1000;
    }
    .voteBtn {
      position: fixed;
      bottom: 10px;
      padding: 10px 20px;
      background: #4285F4; color: white;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      z-index: 1000;
      margin: 0 5px;
    }
    #radioToggle {
      position: absolute; top: 90px; right: 10px;
      background: orange; color: white;
      padding: 5px 10px;
      cursor: pointer; z-index:1000;
    }
    #message {
      position: absolute;
      top: 130px; left: 10px;
      background: red;
      color: white;
      padding: 5px 10px;
      border-radius: 4px;
      display: none;
      z-index: 1000;
    }
  </style>
</head>
<body>
  <div id="modeLabel">Режим: Голосование</div>
  <div id="voteResults">Голосов: ←0 | ↑0 | →0</div>
  <select id="citySelect">
    <option value="Berlin">Берлин</option>
    <option value="Leipzig">Лейпциг</option>
    <option value="Dresden">Дрезден</option>
    <option value="Novorossiysk">Новороссийск</option>
  </select>
  <div id="radioToggle">▶ Радио</div>
  <div id="message"></div>
  <div id="map"></div>
  <div id="street-view"></div>

  <button class="voteBtn" style="left:10px;" data-dir="left">⬅</button>
  <button class="voteBtn" style="left:50%;" data-dir="straight">⬆</button>
  <button class="voteBtn" style="right:10px;" data-dir="right">➡</button>

  <script src="https://telegram.org/js/telegram-web-app.js"></script>
  <script>
    let map, streetView;
    let voteCounts = { left: 0, straight: 0, right: 0 };
    let userVotes = {};
    let radio = new Audio("https://icecast.radiohitz.club/club.mp3");
    radio.loop = true;
    radio.volume = 0.5;
    let radioPlaying = false;
    let currentMode = "voting";

    const cities = {
      Berlin: { lat: 52.52, lng: 13.405 },
      Leipzig: { lat: 51.3397, lng: 12.3731 },
      Dresden: { lat: 51.0504, lng: 13.7373 },
      Novorossiysk: { lat: 44.7236, lng: 37.7689 }
    };

    function initMap() {
      map = new google.maps.Map(document.getElementById("map"), {
        zoom: 14,
        center: cities.Novorossiysk
      });
      streetView = new google.maps.StreetViewPanorama(document.getElementById("street-view"), {
        position: cities.Novorossiysk,
        pov: { heading: 0, pitch: 0 },
        visible: true
      });
      map.setStreetView(streetView);
    }

    function updateVotes() {
      document.getElementById("voteResults").textContent =
        `Голосов: ←${voteCounts.left} | ↑${voteCounts
